<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hufflepuff Dashboard</title>
  
  <!-- 1) 引入 Pangolin 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Pangolin&display=swap" 
    rel="stylesheet"
  >
  
  <!-- 2) 引入 particles.js 库 (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  
  <style>
    /* ========= Reset & Global ========= */
    * {
      margin: 0; 
      padding: 0; 
      box-sizing: border-box;
    }
    body {
      display: flex;
      min-height: 100vh;
      font-family: 'Pangolin', cursive; /* 使用 Pangolin */
      font-size: 18px;
      line-height: 1.6;
      color: #4d3b2f;       /* 深棕，易阅读 */
      /* 不再设置 body 的背景色，交由粒子特效层 + (可选) 背景颜色/图片 */
      position: relative;
      overflow-x: hidden;  /* 防止粒子超出屏幕时出现水平滚动条 */
    }
    
    /* 粒子背景容器：置于底层 */
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: -1; /* 保证内容在粒子之上 */
      background: #f6f2e7; /* 基础米黄，可根据需求改成更神秘的深色图案 */
    }

    a {
      text-decoration: none;
      color: inherit;
      transition: color 0.3s;
    }
    a:hover {
      color: #b38b14; /*hover时加点金色调 */
    }

    /* ========= Left Sidebar ========= */
    .sidebar {
      width: 220px;
      background: #3d3c2e; /* 深色偏棕黑，接近Hufflepuff“soil” */
      padding: 2rem 1rem;
      position: fixed;
      top: 0;
      bottom: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      z-index: 10; /* 在粒子之上 */
    }
    .sidebar .title {
      font-size: 2rem;
      margin-bottom: 2rem;
      color: #fce6c9;
      text-align: center;
    }
    .nav-links {
      list-style: none;
      font-size: 1.25rem;
    }
    .nav-links li {
      margin-bottom: 1.2rem;
    }
    .nav-links li a {
      color: #fce6c9;
      font-weight: bold;
      padding: 0.4rem 0.6rem;
      border-radius: 6px;
      display: inline-block;
      transition: background 0.3s, color 0.3s;
    }
    /* 悬停时背景高亮 */
    .nav-links li a:hover {
      background: #b38b14; 
      color: #fff;
    }

    /* ========= Main Content ========= */
    .main-content {
      margin-left: 220px; /* 侧边栏预留 */
      flex: 1;
      padding: 2rem;
      position: relative;
      z-index: 10; /* 确保内容在粒子之上 */
    }
    .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .header-title {
      font-size: 2rem;
      color: #b38b14; /* 金黄 */
    }

    /* ========= BoomBoom's panel ========= */
    .boom-panel {
      background: #fff8e1; /* 浅黄色底 */
      border: 2px dashed #b38b14; 
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .boom-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: #fff3c1;
      overflow: hidden;
      flex-shrink: 0;
    }
    .boom-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .boom-text {
      flex: 1;
    }
    .boom-text h2 {
      font-size: 1.6rem;
      color: #8c6e0c;
      margin-bottom: 0.5rem;
    }
    .typed-line {
      color: #6b4b0c;
      font-size: 1rem;
      white-space: pre-wrap;
    }

    /* ========= Dashboard Grid ========= */
    .dashboard-grid {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 两列 */
      gap: 1.5rem;
    }
    /* 让每个“模块”有类似卡片背景 */
    .card {
      background: #fffef6;
      border: 2px dashed #d0bb8c;
      border-radius: 10px;
      padding: 1rem;
      position: relative;
      min-height: 200px;
    }
    .card h2 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: #5c4b12;
    }
    .card p {
      margin-bottom: 0.5rem;
    }

    /* ========= Calendar (module) ========= */
    .calendar-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .calendar-nav button {
      background: #8b6d0c;
      color: #fff;
      border: none;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      cursor: pointer;
    }
    .calendar-table {
      width: 100%;
      border-collapse: collapse;
      text-align: center;
    }
    .calendar-table th,
    .calendar-table td {
      border: 1px solid #e0d7b8;
      width: 14.28%;
      height: 60px;
      position: relative;
      vertical-align: middle;
      font-weight: 500;
      color: #4d3b2f;
    }
    .calendar-table td.today {
      color: #f6c634; /* 当天数字标黄色 */
      font-weight: bold;
    }
    .calendar-table td.completed-day {
      background: #fff4c2; /* 金黄色底 */
    }

    /* ========= ToDo Preview (module) ========= */
    .todo-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .todo-list li {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .todo-list input[type="checkbox"] {
      margin-right: 0.5rem;
      transform: scale(1.3);
    }
    .todo-completed {
      text-decoration: line-through;
      color: #999;
    }
    .todo-title {
      cursor: pointer;
      color: #b38b14;
      text-decoration: underline;
      margin-bottom: 0.5rem;
      display: inline-block;
    }

    /* ========= Mood & Wish Form (module) ========= */
    .mood-form .emoji-rating {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .mood-form .emoji-rating label {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
    }
    .mood-form .emoji-rating input[type="radio"] {
      display: none; /* 隐藏原始单选按钮 */
    }
    .mood-form .emoji-rating span {
      font-size: 1.6rem; /* 放大表情 */
      user-select: none;
    }
    /* 选中时可加大或改变边框 */
    .mood-form .emoji-rating input[type="radio"]:checked + span {
      transform: scale(1.2);
      text-shadow: 0 0 5px #b38b14;
    }
    .mood-form input[type="text"] {
      display: block;
      width: 100%;
      margin-bottom: 0.5rem;
      padding: 0.4rem;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .mood-form button {
      background: #8b6d0c;
      color: #fff;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* ========= Responsive ========= */
    @media(max-width: 768px) {
      .sidebar {
        width: 180px;
      }
      .main-content {
        margin-left: 180px;
      }
      .dashboard-grid {
        grid-template-columns: 1fr; /* 变为单列 */
      }
      .boom-panel {
        flex-direction: column;
        align-items: flex-start;
      }
    }

  </style>
</head>
<body>

  <!-- 粒子效果容器（放在最上层body的第一个位置） -->
  <div id="particles-js"></div>

  <!-- ======== Sidebar ======== -->
  <aside class="sidebar">
    <div class="title">Wizard Navigation</div>
    <ul class="nav-links">
      <li><a href="#">Dashboard</a></li>
      <li><a href="#">Badge Room</a></li>
      <li><a href="#">To Do List</a></li>
      <li><a href="#">Wish & Mood</a></li>
      <li><a href="#">Destiny Room</a></li>
      <li><a href="#">Owl Tower</a></li>
    </ul>
  </aside>

  <!-- ======== Main Content ======== -->
  <main class="main-content">
    <!-- Header Row -->
    <div class="header-row">
      <h1 class="header-title">Dashboard</h1>
    </div>

    <!-- BoomBoom Panel (Avatar + typed text) -->
    <div class="boom-panel">
      <div class="boom-avatar">
        <!-- 使用assets/images/owl-hi.png，请确保路径一致 -->
        <img src="assets/images/owl-hi.png" alt="Professor Boom Boom" />
      </div>
      <div class="boom-text">
        <h2>Welcome, fluffy little Puffle!</h2>
        <p id="todayInfo" style="font-size:1rem; margin-bottom:0.5rem;"></p>
        <div class="typed-line" id="boomBoomLine"></div>
      </div>
    </div>

    <!-- Dashboard Grid: Calendar, ToDo, Rewards, etc. -->
    <div class="dashboard-grid">
      <!-- Left Column Top: Calendar -->
      <div class="card" id="calendarCard">
        <div class="calendar-nav">
          <button id="prevMonthBtn">&lt;</button>
          <span id="calendarTitle" style="font-weight:bold;"></span>
          <button id="nextMonthBtn">&gt;</button>
        </div>
        <table class="calendar-table">
          <thead>
            <tr>
              <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th>
              <th>Thu</th><th>Fri</th><th>Sat</th>
            </tr>
          </thead>
          <tbody id="calendarBody"><!-- JS生成 --></tbody>
        </table>
      </div>

      <!-- Right Column Top: ToDo List Preview -->
      <div class="card">
        <h2><span class="todo-title" onclick="location.href='#';">To Do List</span></h2>
        <div class="todo-list" id="todoPreview">
          <!-- JS填充任务 -->
        </div>
      </div>

      <!-- Left Column Bottom: Badges & Shards -->
      <div class="card">
        <h2>Progress & Rewards</h2>
        <p>Badges earned: <span style="color:#b38b14;font-weight:bold" id="badgeCount">5</span></p>
        <p>Shards collected: <span style="color:#b38b14;font-weight:bold" id="shardCount">12</span></p>
        <p>Complete 2 more fun mini-tasks to unlock a golden card draw!</p>
      </div>

      <!-- Right Column Bottom: Quick Mood & Wish -->
      <div class="card">
        <h2>Quick Wish</h2>
        <p>Add a simple wish to the wishing pool. Let your dreams float among firefly sparks!</p>
        <form class="mood-form" id="moodWishForm">
          <!-- 5档emoji评分 -->
          <div class="emoji-rating">
            <label>
              <input type="radio" name="mood" value="veryhappy" />
              <span>😁</span>
            </label>
            <label>
              <input type="radio" name="mood" value="happy" />
              <span>🙂</span>
            </label>
            <label>
              <input type="radio" name="mood" value="neutral" />
              <span>😐</span>
            </label>
            <label>
              <input type="radio" name="mood" value="sad" />
              <span>🙁</span>
            </label>
            <label>
              <input type="radio" name="mood" value="verysad" />
              <span>😢</span>
            </label>
          </div>
          <input type="text" id="wishInput" placeholder="Any fun wish in mind?" />
          <button type="submit">Cast Wish</button>
        </form>
      </div>
    </div>
  </main>

  <!-- 3) JavaScript - typed text, calendar, tasks, mood form, and particles config -->
  <script>
    // ========= 0. Date Info =========
    const todayInfo = document.getElementById('todayInfo');
    const now = new Date();
    const dateOptions = { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' };
    todayInfo.textContent = "Today is " + now.toLocaleDateString('en-US', dateOptions);

    // ========= 1. BoomBoom's random lines =========
    const boomBoomLines = [
      "Toot toot! Good morning, my sparkly friend! Did you brew your coffee with pixie dust today?",
      "Oops, watch out! I just sneezed confetti. That means today’s your lucky day!",
      "Greetings, oh marvelous mortal! The chocolate frogs salute you.",
      "Your socks may not match, but your heart sure does shine!",
      "Poof! I see a bright future with a flying teacup in it for you.",
      "A silly wand wave never hurt anyone—except that one time with the library books. Let’s forget that!",
      "Tick-tock, wizard clock. Time to dance with your broom, or is it mop day?",
      "Hey, keep that chin up, or the potion will bubble right into your nose!",
      "Puff up your feathers and strut around! Confidence is half the magic.",
      "A pinch of laughter plus a dash of wonder equals your next big idea!",
      "Remember: It's impossible to be grumpy around a happy owl. So cheer up, or I’ll hoot!",
      "If a giant toad offers you tea, politely decline. Trust me on this.",
      "Rainbow sprinkles for your cereal? Absolutely yes!",
      "One tiny giggle can chase away a big storm cloud!",
      "Hold onto your quill! Great adventures start with scribbles and doodles.",
      "Who needs normalcy when you can have magical chaos in style?",
      "Mind if I pop this bubble? It’s floating right by your ear, so watch out!",
      "Time for a quick victory dance—no reason needed, just celebrating you!",
      "Did you remember to feed your invisible cat today? It’s meowing behind you right now!",
      "Sparkle like a star, dear apprentice. The night sky is your runway!",
      "Hoooo... Did I just see a dancing cupcake behind you? Must be Tuesday!",
      "Flying lessons at dawn: Bring your best broom and a rubber duck just in case!",
      "When in doubt, toss some glitter around—it's an instant party!",
      "Poke your wand at the sky and say 'Yes, Universe, I am ready!'",
      "Tonight’s forecast: 80% chance of giggles, 20% chance of random fireworks!",
      "Your smile is the best potion I’ve ever seen—bottling it might be dangerous though!",
      "Careful, I’m about to do a silly magical jig. No cameras, please!",
      "Oh, I’m wise and all, but sometimes I forget where I put my wizard hat!",
      "Bibbidi-bobbidi-woo! Did that help? Probably not, but hey, it sounded fun!",
      "Don't fuss with your hair; you’re already a masterpiece of messy magic!",
      "If you see a giant cookie wandering around, let me know. I’m hungry!",
      "Caw-caw! Oops, wrong bird. Let’s pretend that didn’t happen!",
      "Nothing is more powerful than a curious mind... except maybe a dragon with a cold!",
      "Be bold, be bizarre, be the best banana in the fruit basket!",
      "Wander through your day as if it’s a treasure hunt—X marks the snack spot!",
      "A riddle a day keeps the trolls away. Unless they want your leftover pizza!",
      "Tell your worries to hush. There’s no room for gloom in a wizard’s broom closet!",
      "Oops, I might have turned your pen into a carrot. Sorry ’bout that!",
      "Poof! You’re unstoppable. Now go forth and wiggle your toes in victory!",
      "An owl never forgets a friend, or a midnight snack. Speaking of which...",
      "Every time you blink, a fairy does a cartwheel. Or so I'm told!",
      "Laugh lines on your face? Those are the real magic runes!",
      "I found a wand under your pillow—who's been conjuring midnight milkshakes?",
      "No matter how busy you are, there's always time for a goofy grin!",
      "Never mind mistakes—call them 'funky spells' and carry on!",
      "Your magical aura is shining so bright, I'm going to need tiny owl sunglasses!",
      "If life gives you lemons, enchant them to float around and amuse you!",
      "I’m not lost, I’m just exploring every corner of your day with a flourish!",
      "Party trick idea: Juggle stardust while humming your favorite tune!",
      "Adventures are like potions: you never know what's brewing until it pops!"
    ];

    // 随机一句 + 打字机特效
    const typedLineEl = document.getElementById('boomBoomLine');
    const line = boomBoomLines[Math.floor(Math.random() * boomBoomLines.length)];
    let i = 0;
    const speed = 35;
    function typeWriter() {
      if (i < line.length) {
        typedLineEl.textContent += line.charAt(i);
        i++;
        setTimeout(typeWriter, speed);
      }
    }
    typeWriter();

    // ========= 2. Calendar with < > to navigate months =========
    const calendarBody = document.getElementById('calendarBody');
    const calendarTitle = document.getElementById('calendarTitle');
    let currentYear = now.getFullYear();
    let currentMonth = now.getMonth(); // 0 ~ 11

    function renderCalendar(year, month) {
      // 清空tbody
      calendarBody.innerHTML = '';

      // 标题： Month Year
      const monthNames = ["January","February","March","April","May","June",
                          "July","August","September","October","November","December"];
      calendarTitle.textContent = `${monthNames[month]} ${year}`;

      // 当月1号是周几
      const firstDay = new Date(year, month, 1).getDay();
      // 当月天数
      const daysInMonth = new Date(year, month+1, 0).getDate();

      let dateNum = 1;
      for (let row = 0; row < 6; row++) {
        let rowHtml = '<tr>';
        for (let col = 0; col < 7; col++) {
          if ((row === 0 && col < firstDay) || (dateNum > daysInMonth)) {
            rowHtml += '<td></td>'; // 空单元
          } else {
            let classes = '';
            // 当天
            if (year === now.getFullYear() && month === now.getMonth() && dateNum === now.getDate()) {
              classes += ' today';
            }
            // 任务全部完成示例：假设每月10号
            if (dateNum === 10) {
              classes += ' completed-day';
            }
            rowHtml += `<td class="${classes}">${dateNum}</td>`;
            dateNum++;
          }
        }
        rowHtml += '</tr>';
        calendarBody.innerHTML += rowHtml;
        if (dateNum > daysInMonth) break;
      }
    }
    // 初始渲染
    renderCalendar(currentYear, currentMonth);

    // 上/下个月按钮
    document.getElementById('prevMonthBtn').addEventListener('click', ()=>{
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      renderCalendar(currentYear, currentMonth);
    });
    document.getElementById('nextMonthBtn').addEventListener('click', ()=>{
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      renderCalendar(currentYear, currentMonth);
    });

    // ========= 3. ToDo List Quick Preview =========
    const todoPreviewEl = document.getElementById('todoPreview');
    const sampleTasks = [
      { id: 1, text: "Water the baby mandrakes", done: false },
      { id: 2, text: "Collect 3 shining mushrooms", done: true },
      { id: 3, text: "Practice broom flying for 15 min", done: false },
    ];
    function renderTodoList() {
      let html = '<ul>';
      sampleTasks.forEach(task => {
        html += `
          <li>
            <input type="checkbox" data-id="${task.id}" ${task.done ? 'checked' : ''}>
            <span class="${task.done ? 'todo-completed' : ''}">${task.text}</span>
          </li>`;
      });
      html += '</ul>';
      todoPreviewEl.innerHTML = html;
    }
    renderTodoList();
    // 勾选切换
    todoPreviewEl.addEventListener('change', e => {
      if(e.target.matches('input[type="checkbox"]')) {
        const id = parseInt(e.target.dataset.id);
        const task = sampleTasks.find(t => t.id === id);
        if(task) {
          task.done = e.target.checked;
          renderTodoList();
        }
      }
    });

    // ========= 4. Quick Mood & Wish Form =========
    const moodWishForm = document.getElementById('moodWishForm');
    moodWishForm.addEventListener('submit', e => {
      e.preventDefault();
      // 获取被选中的emoji
      const selectedMood = document.querySelector('input[name="mood"]:checked');
      const moodValue = selectedMood ? selectedMood.value : "none";
      const wishInput = document.getElementById('wishInput');
      const wishValue = wishInput.value.trim();
      if (moodValue !== "none" || wishValue) {
        alert(`Saved!\nMood: ${moodValue}\nWish: ${wishValue}`);
        // 可自行存后端或 localStorage
      } else {
        alert("Please pick a mood or enter a wish!");
      }
      // 重置
      moodWishForm.reset();
    });

    // ========= 5. Particles.js Config =========
    // 你可以根据 https://vincentgarreau.com/particles.js/ 自定义更多选项
    particlesJS("particles-js", {
      "particles": {
        "number": {
          "value": 50,
          "density": { "enable": true, "value_area": 800 }
        },
        "color": {
          "value": ["#FFFBE6","#FFD700","#FFECB3"] /* 魔法金色系 */
        },
        "shape": {
          "type": "star", 
          "stroke": { "width": 0, "color": "#ffffff" }
        },
        "opacity": {
          "value": 0.8,
          "random": true
        },
        "size": {
          "value": 6,
          "random": true
        },
        "line_linked": {
          "enable": false
        },
        "move": {
          "enable": true,
          "speed": 1.5,
          "direction": "none",
          "random": true,
          "straight": false,
          "out_mode": "out",
          "bounce": false
        }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": {
          "onhover": { "enable": true, "mode": "repulse" },
          "onclick": { "enable": true, "mode": "push" }
        },
        "modes": {
          "repulse": { "distance": 80, "duration": 0.4 },
          "push": { "particles_nb": 3 }
        }
      },
      "retina_detect": true
    });
  </script>
</body>
</html>
